### 로그인 후 접근할 수 없는 페이지는 afterLoginUri 값을 유지

**1\)  Ut.getPramMap**

```java
   public static Map<String, String> getParamMap(HttpServletRequest request) {
		Map<String, String> param = new HashMap<>();

		Enumeration<String> parameterNames = request.getParameterNames();

		while (parameterNames.hasMoreElements()) {
			String paramName = parameterNames.nextElement();
			String paramValue = request.getParameter(paramName);

			param.put(paramName, paramValue);
		}

		return param;
	}
```

- http요청시 파라미터와 값을 HashMap으로 반환 하는 메소드

**2\) rq.getAfterLoginUri()**

```java
	 public String getAfterLoginUri() {
		String requestUri = req.getRequestURI();
		
		switch (requestUri) {
		case "/usr/member/login":
		case "/usr/member/join":
		case "/usr/member/findLoginId":
		case "/usr/member/findLoginPw":
			return Ut.getUriEncoded(paramMap.get("afterLoginUri"));
		}
		return getEncodedCurrentUri();
	}
```

- 아래의 메소드는 로그인 버튼 클릭시 현재 uri를 더하는 메소드

  ```java
  public String getLoginUri() {
  		return "../member/login?afterLoginUri=" + getAfterLoginUri();
  	}
  ```

  - getAfterLoginUri()는 현재페이지의 uri를 반환

- ```로그인 페이지```에서 ```로그인 버튼```을 누르게되면 AfterLoginUri가 ```계속 더한값```이 나오는 문제 발생

- 또한 로그인페이지에서 로그인 버튼을 클릭후 로그인시 원래 있던 페이지가  ```로그인 페이지```로 적용되는 문제 발생

- 이를 해결 하기위해 ```getAfterLoginUri()``` 수정

- ```http://localhost:8081/usr/home/main``` 뷰에서 로그인 버튼의 href는 ```../member/login?afterLoginUri=``` + ```/usr/home/main```

- ```../member/login?afterLoginUri=``` + /usr/home/main 에서 

- 로그인 버튼(즉, ```로그인 페이지에서 로그인버튼```)의 href는 ```../member/login?afterLoginUri=``` + ```paramMap에 afterLoginUri의 값```이 된다.
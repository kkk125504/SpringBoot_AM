### 로그인 후 원래 요청한 페이지로 이동 

**1\) NeedLoginInterceptor**

```java
public class NeedLoginInterceptor implements HandlerInterceptor {
	@Autowired
	private Rq rq;
	
	@Override
	public boolean preHandle(HttpServletRequest req, HttpServletResponse resp, Object handler) throws Exception {
		if(!rq.isLogined()) {
			String afterReplaceUri = rq.getEncodedCurrentUri();
			rq.printReplaceJs("로그인 후 이용가능 합니다.","../member/login?afterReplaceUri="+afterReplaceUri);
			return false;
		}
		
		return HandlerInterceptor.super.preHandle(req, resp, handler);
	}
}
```

- 로그인후 요청한 페이지로 이동 시키기 위해 uri를 알아야한다.
- rq객체로 부터 uri를(```rq.getEncodedCurrentUri()```) 가져오고 로그인 페이지에 전달

**2\) 로그인.jsp**

```java
<input type="hidden" name="afterReplaceUri" value="${param.afterReplaceUri }"/>
```

- 실질적으로 세션에 로그인 정보를 기록하는 doModify(controller)에  ```afterReplaceUri```데이터를 함께 전달하기위함

**3\) doLogin**	

```java
@RequestMapping("/usr/member/doLogin")
	@ResponseBody
	public String doLogin(String loginId, String loginPw, @RequestParam(defaultValue = "/") String afterReplaceUri) {
						~~~ 생 략 ~~~
		return Ut.jsReplace(Ut.f("%s님 환영합니다.", member.getName()), afterReplaceUri);
	}
```

- 세션에 로그인 정보를 기록 후 로그인 페이지 전달받은 ```afterReplaceUri```로 이동

